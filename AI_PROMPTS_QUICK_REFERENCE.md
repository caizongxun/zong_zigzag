# ZigZag v1.2.0 - AI 開發提示詞快速參考

## 專案資訊

**GitHub:** https://github.com/caizongxun/zong_zigzag
**分支:** v1.2-label-system
**版本:** v1.2.0
**當前推薦參數:**
- fib_proximity: 0.002
- bb_proximity: 0.002
- zigzag_threshold: 0.3

---

## 快速使用指南

### 第一階段：數據層 (1-2 週)

**完整提示詞位置:** `AI_PROMPTS_V1.2.0.md` - 第一階段

**核心需求:**
1. 分數階差分特徵 (d=0.4)
2. 衍生品特徵 (Funding Rate + OI 背離)
3. 微結構特徵 (訂單簿不平衡)
4. 特徵標準化與質量檢查

**輸出文件:** `v1.2_label_system/feature_engineering.py`

**驗證方式:**
```bash
cd /content/zong_zigzag/v1.2_label_system
python quick_test.py  # 驗證推薦參數
```

**成功指標:**
- 進場比例: 8-15%
- 成功率: 35-40%
- 平均回報: 0.5-1.0%

---

### 第二階段：模型層 (2-3 週)

**完整提示詞位置:** `AI_PROMPTS_V1.2.0.md` - 第二階段

**核心需求:**
1. LSTM 初級模型 (含 Attention)
2. XGBoost 元模型 (二層過濾)
3. 三重障礙法標籤生成
4. 自定義損失函數

**輸出文件:**
- `models/lstm_v1.2.0.h5`
- `models/xgb_v1.2.0.json`
- `models/metadata_v1.2.0.json`

**超參數建議:**
```yaml
LSTM:
  hidden_size: 128 (layer 1), 64 (layer 2)
  dropout: 0.3
  learning_rate: 0.001
  batch_size: 64
  epochs: 100
  early_stopping: patience=10

XGBoost:
  n_estimators: 200
  max_depth: 6
  learning_rate: 0.05
  subsample: 0.8
```

**成功指標:**
- LSTM Precision > 70%
- XGBoost AUC > 75%
- F1-Score (weighted) > 0.65

---

### 第三階段：策略層 (1 週)

**完整提示詞位置:** `AI_PROMPTS_V1.2.0.md` - 第三階段

**核心需求:**
1. 入場點位計算 (Fibonacci + VPVR)
2. 止損/止盈設置 (ATR 動態)
3. 過濾邏輯 (5 層)
4. 訂單簿分析
5. 成交量分佈分析
6. 實時監控

**輸出文件:** `v1.2_label_system/strategy_executor.py`

**輸出格式:**
```
=====================================================
交易信號 - BTCUSDT 15m
=====================================================
方向:         UP (看漲)
推薦入場價:   3000 (基於強支撐)
止損價:       2950
止盈價:       3050

風險:        50 (entry - stop_loss)
收益:        100 (take_profit - entry)
風險/收益:    1:2

模型置信度:   0.85

理由:         基於 Fibonacci 支撐 + LSTM 上升信號
=====================================================
```

---

## 推薦 AI 工具

### 第一階段 (數據層) - 推薦 **Claude 3 Opus**
- 優勢: 長上下文，適合複雜特徵工程
- 缺點: 無法直接執行代碼

### 第二階段 (模型層) - 推薦 **ChatGPT-4**
- 優勢: 代碼生成能力最強，DL 經驗豐富
- 缺點: 長文檔可能被截斷

### 第三階段 (策略層) - 推薦 **GitHub Copilot**
- 優勢: IDE 集成，實時代碼補全
- 缺點: 需要 VS Code/IDE

---

## 完整提示詞結構

### 每個階段的標準提示詞框架

```markdown
1. 角色設定
   "請擔任資深 [職位]"

2. 背景信息
   - GitHub 倉庫
   - 分支名稱
   - 版本號
   - 當前指標
   - 推薦參數

3. 具體需求
   - 需求 1: 詳細說明
   - 需求 2: 詳細說明
   - ...

4. 輸出要求
   - 完整代碼
   - 數學解釋
   - 使用示例
   - 文檔註釋

5. 約束條件
   - 技術棧: PyTorch / TensorFlow
   - 版本: Python 3.8+
   - 依賴: pandas, numpy, xgboost
```

---

## 常見提示詞模板

### 模板 1: 代碼優化
```
請優化以下 [language] 函數:

[粘貼現有代碼]

優化目標:
1. 提高計算效率
2. 提高代碼可讀性
3. 添加類型提示
4. 完整的異常處理

輸出: 優化後的完整代碼 + 性能對比
```

### 模板 2: Bug 修復
```
以下代碼在測試時出現問題:

[粘貼有問題的代碼]

錯誤信息: [粘貼錯誤日誌]

請診斷問題並提供修復方案。

輸出: 修復後的代碼 + 問題分析 + 預防措施
```

### 模板 3: 功能擴展
```
項目: ZigZag v1.2.0 (https://github.com/caizongxun/zong_zigzag)
分支: v1.2-label-system

現有模塊: [描述]

新需求: [具體需求]

技術約束:
- Python 3.8+
- 與現有代碼兼容
- 支持多進程並行

輸出: 
1. 完整的代碼實現
2. 集成說明
3. 單元測試
4. 使用示例
```

---

## 最佳實踐

### 提示詞寫作技巧

1. **明確角色**
   - ✅ "請擔任資深機器學習工程師"
   - ❌ "幫我寫代碼"

2. **提供上下文**
   - ✅ "專案: ZigZag v1.2.0 (加密貨幣反轉預測)"
   - ❌ "我需要一個模型"

3. **明確輸出格式**
   - ✅ "輸出: Python 代碼 + 數學公式 + 使用示例"
   - ❌ "給我代碼"

4. **分段提問**
   - ✅ 先問特徵工程 → 再問模型 → 最後問策略
   - ❌ 一次性提問所有內容

5. **提供範例**
   - ✅ "類似這樣的格式: [示例代碼]"
   - ❌ "按你的方式做"

### 驗證 AI 輸出

```python
# 檢查清單
[ ] 代碼能否直接運行？
[ ] 有否類型提示 (Type Hints)？
[ ] 有否完整的 docstring？
[ ] 異常處理是否充分？
[ ] 與現有代碼是否相容？
[ ] 性能是否達到預期？
[ ] 是否有單元測試？
```

---

## 工作流程示例

### Day 1-2: 數據層準備
```
1. 複製完整的「第一階段提示詞」
2. 修改參數: 將 [你的信息] 替換為實際值
3. 在 ChatGPT/Claude 中執行
4. 獲得 feature_engineering.py
5. 運行: python quick_test.py 驗證
6. 根據結果調整特徵
```

### Day 3-7: 模型層開發
```
1. 複製「第二階段提示詞」
2. 分段提問:
   - 先問 LSTM 架構
   - 再問 XGBoost 集成
   - 最後問損失函數
3. 整合代碼
4. 運行訓練: python grid_search_params.py
5. 調試模型
```

### Day 8: 策略層實現
```
1. 複製「第三階段提示詞」
2. 要求 AI 生成完整的 strategy_executor.py
3. 集成到系統
4. 端到端測試
5. 準備上線
```

---

## 故障排除

### AI 的答案不夠詳細?
**解決方案:**
```
原提示詞 + 下文:
"請更詳細地解釋 [部分]。
特別是關於 [具體問題]。
請提供 [數量] 個代碼示例。"
```

### 代碼與現有項目不相容?
**解決方案:**
```
"這段代碼與 v1.2_label_system 中的 [具體文件] 不相容。
請基於以下現有代碼進行修改:
[粘貼現有代碼]"
```

### 性能不達預期?
**解決方案:**
```
"上述實現的性能是 [當前性能]，
但我們的目標是 [目標性能]。
請建議優化方案。"
```

---

## 資源連結

| 資源 | 連結 |
|------|------|
| 完整提示詞 | [AI_PROMPTS_V1.2.0.md](./AI_PROMPTS_V1.2.0.md) |
| GitHub 倉庫 | [zong_zigzag](https://github.com/caizongxun/zong_zigzag) |
| 當前分支 | v1.2-label-system |
| 快速測試 | `python quick_test.py` |
| 網格搜索 | `python fast_grid_search.py` |
| 完整搜索 | `python grid_search_params.py` |

---

## 版本歷史

| 版本 | 日期 | 更新 |
|------|------|------|
| 1.0 | 2026-01-11 | 初版發佈 (三階段結構) |

---

**最後更新:** 2026-01-11
**維護者:** ZigZag 開發團隊
